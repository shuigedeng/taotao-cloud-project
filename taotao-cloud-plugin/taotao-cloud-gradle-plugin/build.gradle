buildscript {
    repositories {
        mavenLocal()
        mavenCentral()
        gradlePluginPortal()

        maven {
            url = "https://repo1.maven.org/maven2"
        }

        maven {
            allowInsecureProtocol = true
            url = 'https://maven.aliyun.com/repository/public'
        }
        maven {
            allowInsecureProtocol = true

            credentials {
                username = findProperty("mavenUsername") ?: System.getenv("TAOTAO_CLOUD_MAVEN_USERNAME")
                password = findProperty("mavenPassword") ?: System.getenv("TAOTAO_CLOUD_MAVEN_PASSWORD")
            }
            url = 'https://repo.rdc.aliyun.com/repository/136936-release-reey0l/'
        }
        //阿里云新的仓库
        maven {
            credentials {
                username = findProperty("mavenUsernameNew") ?: System.getenv("TAOTAO_CLOUD_MAVEN_USERNAME_NEW")
                password = findProperty("mavenPasswordNew") ?: System.getenv("TAOTAO_CLOUD_MAVEN_PASSWORD_NEW")
            }
            url = 'https://packages.aliyun.com/60516c4824e1e6fbecd22990/maven/2085441-release-8v0qbs'
        }

        maven {
            allowInsecureProtocol = true
            url = "https://mirrors.cloud.tencent.com/nexus/repository/maven-public/"
        }

        maven {
            allowInsecureProtocol = true
            url = "https://mirrors.huaweicloud.com/repository/maven/"
        }

        maven { url ="https://repo.spring.io/snapshot" }
        maven { url ="https://repo.spring.io/milestone" }
        maven { url ='https://repo.spring.io/release' }

        maven { url ="https://maven.aliyun.com/repository/central" }
        maven { url ="https://maven.aliyun.com/repository/public" }
        maven { url ="https://maven.aliyun.com/repository/google" }
        maven { url ="https://maven.aliyun.com/repository/gradle-plugin" }
        maven { url ="https://maven.aliyun.com/repository/spring" }
        maven { url ="https://maven.aliyun.com/repository/spring-plugin" }
        maven { url ="https://maven.aliyun.com/repository/grails-core" }
        maven { url ="https://maven.aliyun.com/repository/apache-snapshots" }

        maven { url ="https://repository.aspose.com/repo/" }
        maven { url ="https://repo.e-iceblue.cn/repository/maven-public/" }

        maven { url = "https://s01.oss.sonatype.org/content/repositories/snapshots/" }
    }
}

plugins {
    id "groovy"
    id "java"
    id "java-gradle-plugin"
    id "groovy-gradle-plugin"
    //https://plugins.gradle.org/docs/publish-plugin
    //https://plugins.gradle.org/plugin/com.gradle.plugin-publish
    id "com.gradle.plugin-publish" version "1.3.1"
}

//发布到 https://plugins.gradle.org
apply plugin: "com.gradle.plugin-publish"
apply plugin: "groovy-gradle-plugin"
apply plugin: "java-gradle-plugin"
apply plugin: "groovy"
apply plugin: "java"

dependencies {
    //添加gradle版本
    //implementation 'com.android.tools.build:gradle:3.3.2'
    //implementation 'org.codehaus.groovy:groovy-all:2.5.8'
    //implementation 'org.jetbrains.kotlin:kotlin-gradle-plugin:1.3.21'

    //添加gradle对应api
    implementation gradleApi()
    implementation localGroovy()

    implementation "org.springframework.boot:spring-boot-gradle-plugin:3.5.3"

    testImplementation 'org.junit.jupiter:junit-jupiter:5.13.3'
    testImplementation 'org.junit.jupiter:junit-jupiter-engine:5.13.3'
    testImplementation 'org.junit.jupiter:junit-jupiter-params:5.13.3'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher:1.13.3'
    testImplementation "org.assertj:assertj-core:3.27.3"
}

group = "com.taotao.cloud.gradle"

gradlePlugin {
    website = 'https://github.com/shuigedeng/taotao-cloud-project'
    vcsUrl = 'https://github.com/shuigedeng/taotao-cloud-project.git'
    description = 'taotao-cloud-gradle-plugin'

    //tags里面不允许有gradle plugin
    plugins {
        greetingsPlugin {
            id = 'io.github.shuigedeng.plugin'
            implementationClass = 'com.taotao.cloud.gradle.plugin.MyPlugin'
            displayName = "taotao-cloud-plugin gradle plugin"
            description = 'taotao-cloud-plugin gradle plugin Please use!'
            tags = ['taotao', 'cloud']
        }
        bomPlugin {
            id = "io.github.shuigedeng.plugin.bom"
            implementationClass = "com.taotao.cloud.gradle.springboot.plugin.BomPlugin"
            displayName = 'springboot bom plugin'
            description = 'springboot bom plugin'
            tags = ['taotao', 'cloud', 'bom']
        }
        modulePlugin {
            id = "io.github.shuigedeng.plugin.module"
            implementationClass = "com.taotao.cloud.gradle.springboot.plugin.ModulePlugin"
            displayName = 'springboot module plugin'
            description = 'springboot module plugin'
            tags = ['taotao', 'cloud', 'module']
        }
        commonPlugin {
            id = "io.github.shuigedeng.plugin.common"
            implementationClass = "com.taotao.cloud.gradle.springboot.plugin.CommonPlugin"
            displayName = 'springboot common plugin'
            description = 'springboot common plugin'
            tags = ['taotao', 'cloud', 'common']
        }
        rootProjectPlugin {
            id = "io.github.shuigedeng.plugin.root"
            implementationClass = "com.taotao.cloud.gradle.springboot.plugin.RootPlugin"
            displayName = 'springboot root plugin'
            description = 'springboot root plugin'
            tags = ['taotao', 'cloud', 'root']
        }
        servicePlugin {
            id = "io.github.shuigedeng.plugin.service"
            implementationClass = "com.taotao.cloud.gradle.springboot.plugin.ServicePlugin"
            displayName = 'springboot service plugin'
            description = 'springboot service plugin'
            tags = ['taotao', 'cloud', 'service']
        }
        //deployedPlugin {
        //    id = "io.github.shuigedeng.plugin.deployed"
        //    implementationClass = "com.taotao.cloud.gradle.springboot.plugin.DeployedPlugin"
        //    displayName = 'springboot deployed plugin'
        //    description = 'springboot deployed plugin'
        //    tags = ['taotao', 'cloud', 'plugin', 'deployed']
        //}
    }
}
